import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as i,c as l,a as n,b as s,d as t,e}from"./app-b5401eb7.js";const c={},u=n("h1",{id:"fastapi-学习",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#fastapi-学习","aria-hidden":"true"},"#"),s(" FastAPI 学习")],-1),r={href:"https://fastapi.tiangolo.com/zh/",target:"_blank",rel:"noopener noreferrer"},d=e(`<hr><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#安装fastapi</span>
pip3 <span class="token function">install</span> fastapi
<span class="token comment">#安装AIGC服务器</span>
pip3 <span class="token function">install</span> <span class="token string">&quot;uvicorn[standard]&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em><strong>一个简单的例子：</strong></em></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> typing <span class="token keyword">import</span> Union

<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI

<span class="token comment">#创建一个 FastAPI「实例」</span>
app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">read_root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">}</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/items/{item_id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">read_item</span><span class="token punctuation">(</span>item_id<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> q<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;item_id&quot;</span><span class="token punctuation">:</span> item_id<span class="token punctuation">,</span> <span class="token string">&quot;q&quot;</span><span class="token punctuation">:</span> q<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>uvicorn main:app <span class="token parameter variable">--reload</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,7),k={class:"hint-container tip"},m=n("p",{class:"hint-container-title"},"uvicorn main:app 命令含义",-1),v={href:"http://main.py",target:"_blank",rel:"noopener noreferrer"},b={href:"http://main.py",target:"_blank",rel:"noopener noreferrer"},h=n("p",null,"--reload：让服务器在更新代码后重新启动。仅在开发时使用该选项。",-1),_={href:"http://127.0.0.1:8000",target:"_blank",rel:"noopener noreferrer"},g={href:"http://127.0.0.1:8000/docs",target:"_blank",rel:"noopener noreferrer"},y=n("br",null,null,-1),f=e(`<hr><h2 id="路径参数" tabindex="-1"><a class="header-anchor" href="#路径参数" aria-hidden="true">#</a> 路径参数</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 使用与 python 格式化字符串相同的语法来声明路径的参数</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/items/{item_id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">read_item</span><span class="token punctuation">(</span>item_id<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;item_id&quot;</span><span class="token punctuation">:</span> item_id<span class="token punctuation">}</span>
<span class="token comment"># 路径参数 item_id 的值将作为参数 item_id 传递给 read_item() 函数。</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="预设值" tabindex="-1"><a class="header-anchor" href="#预设值" aria-hidden="true">#</a> 预设值</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum

<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI

<span class="token comment"># 创建一个 python 枚举</span>
<span class="token keyword">class</span> <span class="token class-name">ModelName</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alexnet <span class="token operator">=</span> <span class="token string">&quot;alexnet&quot;</span>
    resnet <span class="token operator">=</span> <span class="token string">&quot;resnet&quot;</span>
    lenet <span class="token operator">=</span> <span class="token string">&quot;lenet&quot;</span>


app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/models/{model_name}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_model</span><span class="token punctuation">(</span>model_name<span class="token punctuation">:</span> ModelName<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> model_name <span class="token keyword">is</span> ModelName<span class="token punctuation">.</span>alexnet<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;model_name&quot;</span><span class="token punctuation">:</span> model_name<span class="token punctuation">,</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Deep Learning FTW!&quot;</span><span class="token punctuation">}</span>

    <span class="token keyword">if</span> model_name<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">&quot;lenet&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;model_name&quot;</span><span class="token punctuation">:</span> model_name<span class="token punctuation">,</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;LeCNN all the images&quot;</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;model_name&quot;</span><span class="token punctuation">:</span> model_name<span class="token punctuation">,</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Have some residuals&quot;</span><span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),q={class:"hint-container info"},w=n("p",{class:"hint-container-title"},"相关信息",-1),P={href:"https://docs.python.org/3/library/enum.html",target:"_blank",rel:"noopener noreferrer"},F=n("h2",{id:"请求体",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#请求体","aria-hidden":"true"},"#"),s(" 请求体")],-1),I=n("ul",null,[n("li",null,"请求体是客户端发送给 API 的数据。"),n("li",null,"响应体是 API 发送给客户端的数据。")],-1),x={class:"hint-container tip"},A=n("p",{class:"hint-container-title"},"提示",-1),N={href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods",target:"_blank",rel:"noopener noreferrer"},U=n("ul",null,[n("li",null,"GET 用于获取资源，"),n("li",null,"POST 用于提交数据，"),n("li",null,"PUT 用于更新资源，"),n("li",null,"DELETE 用于删除资源，"),n("li",null,"PATCH 用于部分更新资源。")],-1),T={href:"https://docs.pydantic.dev/latest/",target:"_blank",rel:"noopener noreferrer"},E=e(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> typing <span class="token keyword">import</span> Union

<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI
<span class="token comment"># 从 pydantic 中导入 BaseModel：</span>
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel

<span class="token comment"># 创建数据模型</span>
<span class="token keyword">class</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    description<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span> <span class="token comment">#默认值为None，是一个可选属性</span>
    price<span class="token punctuation">:</span> <span class="token builtin">float</span>
    tax<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>


app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/items/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create_item</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> Item<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> item
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>请求文件</strong><br> 安装依赖库</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pip3 <span class="token function">install</span> python-multipart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Fastapi 可通过 bytes 形式和 UploadFile 形式读取和接收文件内容；</p><ul><li><strong>bytes</strong>形式是将文件存储在内存中，适合小型文件；</li><li><strong>UploadFile</strong>形式忽略内存限制，可传输大型文件。</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI<span class="token punctuation">,</span> File<span class="token punctuation">,</span> UploadFile

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># bytes 形式</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/files/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create_file</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">:</span> <span class="token builtin">bytes</span> <span class="token operator">=</span> File<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">&quot;A file read as bytes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;file_size&quot;</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token comment"># UploadFile 形式</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">&quot;/uploadfile/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create_upload_file</span><span class="token punctuation">(</span>
    <span class="token builtin">file</span><span class="token punctuation">:</span> UploadFile <span class="token operator">=</span> File<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">&quot;A file read as UploadFile&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">:</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function M(B,C){const a=o("ExternalLinkIcon");return i(),l("div",null,[u,n("p",null,[n("a",r,[s("FastAPI"),t(a)]),s(" 是一个用于构建API的现代、快速（高性能）的web框架，使用Python 3.6+并基于标准的Python类型提示。它具有如下这些优点：快速：可与NodeJS和Go比肩的极高性能（归功于Starlette和Pydantic）；高效编码：提高功能开发速度约200％至300％；更少bug：减少约40％的人为（开发者）导致错误；智能：极佳的编辑器支持，处处皆可自动补全，减少调试时间；简单：设计的易于使用和学习，阅读文档的时间更短；简短：使代码重复最小化，通过不同的参数声明实现丰富功能；健壮：生产可用级别的代码。")]),d,n("div",k,[m,n("p",null,[s("main："),n("a",v,[s("main.py"),t(a)]),s(" 文件。")]),n("p",null,[s("app：在 "),n("a",b,[s("main.py"),t(a)]),s(" 文件中通过 app = FastAPI() 创建的对象。")]),h]),n("p",null,[s("访问： "),n("a",_,[s("http://127.0.0.1:8000"),t(a)]),s("，")]),n("p",null,[s("交互式 API 文档： "),n("a",g,[s("http://127.0.0.1:8000/docs"),t(a)]),y,s(" FastAPI会生成自定义文档，可直接查看api接口和接受的参数属性。")]),f,n("div",q,[w,n("p",null,[n("a",P,[s("python 枚举"),t(a)])])]),F,I,n("div",x,[A,n("p",null,[n("a",N,[s("HTTP 请求方法"),t(a)]),s("：")]),U]),n("p",null,[s("使用 "),n("a",T,[s("Pydantic"),t(a)]),s(" 模型来声明请求体")]),E])}const z=p(c,[["render",M],["__file","fastapi_learn.html.vue"]]);export{z as default};
